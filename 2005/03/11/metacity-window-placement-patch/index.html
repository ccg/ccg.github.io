<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.96.0"><title>Metacity window-placement patch - Chad Glendenin</title><meta property="og:title" content="Metacity window-placement patch - Chad Glendenin"><link href=//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/fonts.css media=all><link rel=stylesheet href=/css/main.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/ccg.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/about/>About</a></li><li><a href=https://github.com/ccg>GitHub</a></li><li><a href=https://twitter.com/ccglen>Twitter</a></li></ul></nav></header><main class=content role=main><article class=article><span class=article-duration>4 min read</span><h1 class=article-title>Metacity window-placement patch</h1><span class=article-date>2005-03-11</span><div class=article-content><h1 id=metacity-window-placement-patch>Metacity window-placement patch</h1><p>A patch to modify Metacity&rsquo;s window-placement algorithm so that all new windows are centered in the viewport.</p><hr><h3 id=2018-02-08-update>2018-02-08 Update</h3><p>I moved the files from my personal web server to a repo on GitHub:</p><p><a href=https://github.com/ccg/metacity-window-placement-patches>https://github.com/ccg/metacity-window-placement-patches</a></p><p>The links below have been updated accordingly.
Also, I put &lsquo;2005-03-11&rsquo; as the date for this post. I lost the original revision
history for this page, and that date is my best guess based on the dates in the
patch files.</p><h3 id=2012-10-11-update>2012-10-11 Update</h3><p>I haven&rsquo;t touched this page in over three years. I still get occasional emails about it, so I&rsquo;m leaving it here, but I&rsquo;m deleting a lot of the old stuff about native packages (Gentoo portage, etc.), because it&rsquo;s so old that I doubt it&rsquo;s useful any more, and I no longer do that sort of thing.</p><h3 id=2009-06-25-update>2009-06-25 Update</h3><p>Clearly, this page is in need of a serious overhaul. In the meantime, please note that the GNOME project has moved their code from Subversion to Git (<a href=http://git.gnome.org/)>http://git.gnome.org/)</a>. So I made a copy of their Git repository on GitHub. Specifically, the official Metacity repo is currently here: <a href=http://git.gnome.org/cgit/metacity/>http://git.gnome.org/cgit/metacity/</a>. I pushed copies of their master and gnome-2-26 branches to my own metacity repository on GitHub. Then I reimplemented my center-placement changes on a new branch called gnome-2-26-center-placement for the GNOME 2.26 release of Metacity: <a href=http://github.com/ccg/metacity/tree/gnome-2-26-center-placement>http://github.com/ccg/metacity/tree/gnome-2-26-center-placement</a> I&rsquo;d be happy to write up instruction on how to straddle two git remote repositories like that if anybody is interested. If you&rsquo;re a new Git user, it&rsquo;s probably not immediately obvious how to do something like that. It took me a few weeks of day-to-day use to become comfortable with Git.</p><hr><h2 id=downloads>Downloads</h2><h3 id=new-simple-patch-that-only-implements-center-placement>New, simple patch that only implements center placement</h3><p>For Metacity 2.14.5:</p><ul><li>New, simple patch: <a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.14/place.c.patch>place.c.patch</a></li><li>Lines of code added: 20</li><li>Lines of code deleted: 380</li></ul><h3 id=old-fancy-patch-with-all-the-options>Old, fancy patch with all the options</h3><p>For Metacity 2.12:</p><ul><li>The patch: <a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.12/metacity-2.12-placement.patch>metacity-2.12-placement.patch</a></li><li><a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.12/metacity.spec>SUSE Linux 10.0 spec file</a></li></ul><p>For Metacity 2.10:</p><ul><li>The patch: <a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.10/metacity-2.10-window-placement.patch>metacity-2.10-window-placement.patch</a></li><li><a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.10/metacity.spec>Fedora Core 4 spec file</a></li></ul><p>For Metacity 2.8:</p><ul><li>The generic patch: <a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.8/metacity-2.8-window-placement.patch>metacity-2.8-window-placement.patch</a></li><li>The patch for RHEL 4 or CentOS 4.3: <a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.8-rhel4/metacity-2.8.6.rhel4-window-placement.patch>metacity-2.8.6.rhel4-window-placement.patch</a></li><li><a href=https://raw.githubusercontent.com/ccg/metacity-window-placement-patches/master/2.8-rhel4/metacity.spec>RHEL/CentOS-4 spec file.</a></li></ul><hr><h2 id=description>Description</h2><h3 id=new-simple-patch>New, simple patch</h3><p>This patch modifies Metacity&rsquo;s window-placement behavior so that it merely centers new windows instead of trying to tile them in groups or cascade them from the upper-left corner.</p><h3 id=old-fancy-patch>Old, fancy patch</h3><p>This patch for Metacity adds a few window-placement options that can be configured in the graphical gconf-editor or with the gconftool-2 command-line program.</p><p>The following options are available:</p><ul><li><code>"first_fit"</code> (<code>"smart"</code> is also accepted)<ul><li>This is the default Metacity window-placement behavior. In this mode, Metacity will attempt to tile new windows on the screen so that they do not overlap.</li></ul></li><li><code>"cascade"</code><ul><li>This skips Metacity&rsquo;s center/tile behavior and cascades new windows the upper-left corner of the current desktop. It uses Metacity&rsquo;s built-in cascading algorithm.</li></ul></li><li><code>"center"</code><ul><li>This option will cause Metacity to place each new window at the center of its workspace.</li></ul></li><li><code>"origin"</code><ul><li>In this mode, Metacity will simply place each new window at the origin (the upper-left corner) of its workspace.</li></ul></li><li><code>"random"</code><ul><li>In this mode, Metacity will choose a random position on the screen for a new window.</li></ul></li></ul><p>After installing the patched version of Metacity, you can change the option as follows:</p><p>In GNOME 2.10, open Configuration Editor from the following menu:</p><p><code>Applications --> System Tools --> Configuration Editor</code></p><p>Then navigate to the placement_mode key:</p><p><code>/ --> apps --> metacity --> general</code></p><p>Right-click on &ldquo;placement_mode&rdquo;, choose &ldquo;Edit Key&mldr;&rdquo; from the pop-up menu, and then set the &ldquo;Value:&rdquo; field to the option you want.</p><p>To change the option from the command line, do this:</p><p><code>gconftool-2 --type string --set /apps/metacity/general/placement_mode random</code></p><p>(but replace &ldquo;random&rdquo; with whichever option you want).</p><hr><h2 id=build-and-install-in-a-home-directory>Build and install in a home directory</h2><p>I like to avoid clutter in my home directory by installing locally built apps into <em>$HOME/opt/name-version</em>. In this case, it would be something like <code>$HOME/opt/metacity-2.16.3</code>. After patching the source:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./configure --prefix<span style=color:#f92672>=</span>$HOME/opt/metacity-2.16.3
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>export GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>make install
</span></span><span style=display:flex><span>unset GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL
</span></span></code></pre></div><p>I usually point my local copy of metacity at the system-wide theme directory:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>cd ~/opt/metacity-2.16.3/share
</span></span><span style=display:flex><span>mv themes themes.original
</span></span><span style=display:flex><span>ln -s /usr/share/themes .
</span></span></code></pre></div><p>After running <code>make</code>, you can test your build by running <code>metacity --replace</code> from the source directory. You should be able to do this before or after installing.</p><p>If everything works, you can make the change permanent by adding a line like the following to <code>~/.gnomerc</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>export WINDOW_MANAGER<span style=color:#f92672>=</span>$HOME/opt/metacity-2.16.3/bin/metacity
</span></span></code></pre></div></div></article></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos>Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li></ul></footer></div><script src=//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js></script>
<script src=//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js></script>
<script src=//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js></script>
<script>hljs.configure({languages:[]}),hljs.initHighlightingOnLoad()</script><script src=/js/math-code.js></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-35516212-1","auto"),ga("send","pageview"))</script></body></html>